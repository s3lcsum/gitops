---
globs: stacks/**/compose.yaml
alwaysApply: false
---
# Docker Compose PostgreSQL Database Access

**Use the centralized PostgreSQL stack** (`stacks/postgres/`) for all database needs. Never deploy separate PostgreSQL instances.

**To add PostgreSQL access for a new service:**

1. **Add to `stacks/postgres/postgres.env`:**
   ```bash
   MYSERVICE_DB_USER=myservice_user
   MYSERVICE_DB_PASSWORD=secure-password-here
   MYSERVICE_DB_NAME=myservice_db
   ```

2. **Add to `stacks/postgres/init.sh`:**
   ```bash
   setup_user_and_database "${MYSERVICE_DB_USER}" "${MYSERVICE_DB_PASSWORD}" "${MYSERVICE_DB_NAME}"
   ```

3. **Connect in your service's compose.yaml:**
   ```yaml
   services:
     myservice:
       environment:
         - DB_URL=postgresql://${MYSERVICE_DB_USER}:${MYSERVICE_DB_PASSWORD}@postgres:5432/${MYSERVICE_DB_NAME}
   ```
