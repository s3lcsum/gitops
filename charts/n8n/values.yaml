# n8n configuration
n8n:
  image:
    repository: n8nio/n8n
    tag: latest
    pullPolicy: IfNotPresent

  # Environment configuration
  config:
    # Base URLs - update these for your domain
    editorBaseUrl: "https://nodemation.wally.dominiksiejak.pl"
    webhookUrl: "https://nodemation.wally.dominiksiejak.pl"

    # Features
    metrics: true
    runnersEnabled: true
    enforceSettingsFilePermissions: true

  # Database configuration (PostgreSQL)
  database:
    type: "postgresdb"
    host: "postgres-cluster-rw"  # CloudNativePG read-write service
    user: "n8n_user"
    password: ""  # Set via secret
    database: "n8n"
    # Secret containing database credentials (auto-generated by postgres chart)
    existingSecret: "n8n-credentials"

  # Encryption key for n8n data
  encryptionKey: ""  # Set via secret

  # PostgreSQL integration
  # When using the postgres chart, the database and credentials are automatically created
  # The n8n database will be available at: postgres-cluster-rw:5432/n8n
  # Credentials are stored in the 'n8n-credentials' secret

  # Resources
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

# Service configuration
service:
  type: ClusterIP
  port: 5678

# Ingress configuration for Traefik
ingress:
  enabled: true
  className: traefik
  annotations:
    traefik.ingress.kubernetes.io/router.tls: "true"
  hosts:
    - host: nodemation.wally.dominiksiejak.pl
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: wally-dominiksiejak-pl-tls
      hosts:
        - nodemation.wally.dominiksiejak.pl

# Persistence for n8n data
persistence:
  enabled: true
  storageClass: ""  # Use default storage class
  accessMode: ReadWriteOnce
  size: 1Gi

# ServiceAccount
serviceAccount:
  create: true
  name: n8n
